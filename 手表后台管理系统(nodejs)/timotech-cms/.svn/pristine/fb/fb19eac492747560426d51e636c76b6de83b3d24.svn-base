/**
 * Author:ShulicTian
 * Date:2017/12/30
 */

var mysqlDao = require('../common/mysql_pool');

exports.getAudios = function (name, callback) {
	var sql = "select resourceId,url,version from t_resource where resourceName=:name";
	mysqlDao.executeList(sql, {"name": name}, callback);
};

exports.getDials = function (name, callback) {
	var sql = "select resourceId,url,version,previewUrl,tag,size from t_resource where resourceName=:name";
	mysqlDao.executeList(sql, {"name": name}, callback);
};

exports.getEmoticons = function (name, callback) {
	var sql = "select resourceId,url,version,tag from t_resource where resourceName=:name";
	mysqlDao.executeList(sql, {"name": name}, callback);
};

exports.getThemes = function (name, callback) {
	var sql = "select resourceId,url,version,previewUrl,tag,size from t_resource where resourceName=:name";
	mysqlDao.executeList(sql, {"name": name}, callback);
};

/**
 *  update
 */
exports.updateAudio = function (resourceId, url, version, callback) {
	var sql = "update t_resource " +
			"set url=:url,version=:version " +
			"where resourceName='audio' and resourceId=:resourceId";
	mysqlDao.executeUpdate(sql, {"resourceId": resourceId, "url": url, "version": version}, callback);
};

exports.updateEmoticon = function (resourceId, url, version, tag, callback) {
	var sql = "update t_resource " +
			"set url=:url,version=:version,tag=:tag " +
			"where resourceName='emoticon' and resourceId=:resourceId";
	mysqlDao.executeUpdate(sql, {"resourceId": resourceId, "url": url, "version": version, "tag": tag}, callback);
};

exports.updateDialAndTheme = function (resourceId, url, version, name, previewUrl, tag, size, callback) {
	var sql = "update t_resource " +
			"set url=:url,version=:version,previewUrl=:previewUrl,tag=:tag,size=:size " +
			"where resourceName=:name and resourceId=:resourceId";
	mysqlDao.executeUpdate(sql, {
		"resourceId": resourceId,
		"url": url,
		"version": version,
		"name": name,
		"previewUrl": previewUrl,
		"tag": tag,
		"size": size
	}, callback);
};

/**
 * save
 */
exports.saveAudio = function (resourceId, url, version, createTime, callback) {
	var sql = "insert into t_resource(resourceName,resourceId,url,version,createTime) " +
			"values('audio',:resourceId,:url,:version,:createTime)";
	mysqlDao.executeUpdate(sql, {
		"resourceId": resourceId,
		"url": url,
		"version": version,
		"createTime": createTime
	}, callback);
};

exports.saveEmoticon = function (resourceId, url, version, tag, createTime, callback) {
	var sql = "insert into t_resource(resourceName,resourceId,url,version,tag,createTime) " +
			"values('emoticon',:resourceId,:url,:version,:tag,:createTime)";
	mysqlDao.executeUpdate(sql, {
		"resourceId": resourceId,
		"url": url,
		"version": version,
		"tag": tag,
		"createTime": createTime
	}, callback);
};

exports.saveDialAndTheme = function (resourceId, url, version, name, previewUrl, tag, size, createTime, callback) {
	var sql = "insert into t_resource(resourceName,resourceId,url,version,previewUrl,tag,size,createTime) " +
			"values(:name,:resourceId,:url,:version,:previewUrl,:tag,:size,:createTime)";
	mysqlDao.executeUpdate(sql, {
		"resourceId": resourceId,
		"url": url,
		"version": version,
		"name": name,
		"previewUrl": previewUrl,
		"tag": tag,
		"size": size,
		"createTime": createTime
	}, callback);
};

/**
 * delete
 */
exports.deleteAudio = function (resourceId, callback) {
	var sql = "delete from t_resource " +
			"where resourceName='audio' and resourceId=:resourceId";
	mysqlDao.executeUpdate(sql, {"resourceId": resourceId}, callback);
};

exports.deleteEmoticon = function (resourceId, callback) {
	var sql = "delete from t_resource " +
			"where resourceName='emoticon' and resourceId=:resourceId";
	mysqlDao.executeUpdate(sql, {"resourceId": resourceId}, callback);
};

exports.deleteDialAndTheme = function (resourceId, name, callback) {
	var sql = "delete from t_resource " +
			"where resourceName=:name and resourceId=:resourceId";
	mysqlDao.executeUpdate(sql, {
		"resourceId": resourceId,
		"name": name
	}, callback);
};